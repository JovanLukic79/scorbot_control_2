<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="arduinobot">

    <!-- Useful Variables (Properties) -->
    <xacro:property name="PI" value="3.14159265359" />
    <xacro:property name="effort" value="30" />
    <xacro:property name="velocity" value="10" />

    <!-- Useful Macros -->
    <xacro:macro name="default_inertial" params="mass">
        <inertial>
            <mass value="${mass}" />
            <inertia ixx="1.0" ixy="0.0" ixz="0.0"
                     iyy="1.0" iyz="0.0"
                     izz="1.0" />
        </inertial>
    </xacro:macro>
    <xacro:macro name="default_transmission" params="number">
        <transmission name="transmission_${number}">
            <type>transmission_interface/SimpleTransmission</type>
            <joint name="joint_${number}">
                <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
            </joint>
            <actuator name="motor_${number}">
                <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
                <mechanicalReduction>1</mechanicalReduction>
            </actuator>
        </transmission>
    </xacro:macro>


    <!-- Links -->
    
    <link name="world"/>

    <link name="scorbot_base_link">
        <xacro:default_inertial mass="1"/>
        <visual>
            <origin rpy="0 0 0" xyz="0.27 0.0 0.469"/>
            <geometry>
                <mesh filename="package://scorbot_control_2/mesh/base.DAE"/>
            </geometry>
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0.27 0.0 0.469"/>
            <geometry>
                <mesh filename="package://scorbot_control_2/mesh/base.DAE" scale="0.01 0.01 0.01"/>
            </geometry>
        </collision>
    </link>

    <link name="scorbot_link_1">
        <xacro:default_inertial mass="0.1"/>
        <visual>
            <origin rpy="0 0 0" xyz="0.0 0.0 0.075"/>
            <geometry>
                <mesh filename="package:/scorbot_control_2/meshes/shoulder.DAE" scale="0.01 0.01 0.01"/>
            </geometry>
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0.0 0.0 0.075"/>
            <geometry>
                <mesh filename="package://scorbot_control_2/meshes/shoulder.DAE" scale="0.01 0.01 0.01"/>
            </geometry>
        </collision>
    </link>

    <link name="scorbot_link_2">
        <xacro:default_inertial mass="0.1"/>
        <visual>
            <origin rpy=" 0 0 0" xyz="0.11 0.0 0.0"/>
            <geometry>
                <mesh filename="package://scorbot_control_2/meshes/elbow.DAE" scale="0.01 0.01 0.01"/>
            </geometry>
        </visual>
        <collision>
            <origin rpy=" 0 -${PI/2} ${PI/2}" xyz="0.11 0.0 0.0"/>
            <geometry>
                <mesh filename="package://scorbot_control_2/meshes/elbow.DAE" scale="0.01 0.01 0.01"/>
            </geometry>
        </collision>
    </link>

    <link name="scorbot_link_3">
        <xacro:default_inertial mass="0.1"/>
        <visual>
            <origin rpy="${PI/2} 0 ${PI/2}" xyz="-0.03 -0.4 -0.06"/>
            <geometry>
                <mesh filename="package://scorbot_control_2/meshes/end_effector_pitch.DAE" scale="0.01 0.01 0.01"/>
            </geometry>
        </visual>
        <collision>
            <origin rpy="${PI/2} 0 ${PI/2}" xyz="0.12 0.0 0.0"/>
            <geometry>
                <mesh filename="package://scorbot_control_2/meshes/end_effector_pitch.DAE" scale="0.01 0.01 0.01"/>
            </geometry>
        </collision>
    </link>

    <link name="scorbot_link_4">
        <xacro:default_inertial mass="0.05"/>
        <visual>
            <origin rpy="0 0 0" xyz="0.012 0 0"/>
            <geometry>
                <mesh filename="package://scorbot_control_2/meshes/end_effector_roll.DAE" scale="0.01 0.01 0.01"/>
            </geometry>
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0.012 0 0"/>
            <geometry>
                <mesh filename="package://scorbot_control_2/meshes/end_effector_roll.DAE" scale="0.01 0.01 0.01"/>
            </geometry>
        </collision>
    </link>

    <link name="scorbot_link_5">
        <xacro:default_inertial mass="0.01"/>
        <visual>
            <origin rpy="0 0 0" xyz="0.0 0.0 0.02"/>
            <geometry>
                <mesh filename="package://scorbot_control_2/meshes/gripper.STL" scale="0.01 0.01 0.01"/>
            </geometry>
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0.0 0.0 0.02"/>
            <geometry>
                <mesh filename="package://scorbot_control_2/meshes/gripper.STL" scale="0.01 0.01 0.01"/>
            </geometry>
        </collision>
    </link>

    <link name="scorbot_pad1_link">
        <xacro:default_inertial mass="0.01"/>
        <visual>
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <geometry>
                <mesh filename="package://manipulation/description/meshes/pad1.STL" scale="0.01 0.01 0.01"/>
            </geometry>
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <geometry>
                <mesh filename="package://manipulation/description/meshes/pad1.STL" scale="0.01 0.01 0.01"/>
            </geometry>
        </collision>
    </link>

    <link name="scorbot_pad2_link">
        <xacro:default_inertial mass="0.01"/>
        <visual>
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <geometry>
                <mesh filename="package://manipulation/description/meshes/pad2.STL" scale="0.01 0.01 0.01"/>
            </geometry>
        </visual>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <geometry>
                <mesh filename="package://manipulation/description/meshes/pad2.STL" scale="0.01 0.01 0.01"/>
            </geometry>
        </collision>
    </link>

    
    <!-- Joints -->  
    <joint name="virtual_joint" type="fixed">
        <parent link="world"/>
        <child link="scorbot_base_link"/>
        <origin xyz="0 0 0" rpy="0 0 0"/>
    </joint> 

    <joint name ="scorbot_joint_1" type="revolute">
        <parent link="scorbot_base_link"/>
        <child link = "scorbot_link_1"/>
        <origin xyz="0 0 0.2274"/>
        <axis xyz="0 0 1"/>
        <limit lower="-3.1415926535897931" upper="3.1415926535897931" effort="1000" velocity="2"/>
    </joint>

    <joint name ="scorbot_joint_2" type="revolute">
        <parent link="scorbot_link_1"/>
        <child link = "scorbot_link_2"/>
        <origin xyz="0.0255 0 0.13"/>
        <axis xyz="0 0 1"/>
        <limit lower="-0.610865" upper="2.268928" effort="1000" velocity="2"/>
    </joint>

    <joint name ="scorbot_joint_3" type="revolute">
        <parent link="scorbot_link_2"/>
        <child link = "scorbot_link_3"/>
        <origin xyz="0.2225 0 0"/>
        <axis xyz="0 0 1"/>
        <limit lower="-2.268928" upper="2.268928" effort="1000" velocity="2"/>
    </joint>

    <joint name ="scorbot_joint_4" type="revolute">
        <parent link="scorbot_link_3"/>
        <child link = "scorbot_link_4"/>
        <origin xyz="0 0 1"/>
    </joint>

    <joint name ="scorbot_joint_4" type="revolute">
        <parent link="scorbot_link_4"/>
        <child link = "scorbot_link_5"/>
        <origin xyz="0 0 0"/>
        <axis xyz="0 0 1"/>
        <limit
        lower="-3.14159"
        upper="3.14159"
        effort="1000"
        velocity="2" />
    </joint>

    <joint name ="scorbot_pad1_joint" type="revolute">
        <parent link="scorbot_link_5"/>
        <child link = "scorbot_pad1_link"/>
        <origin xyz="0 -0.0545 -0.0905"/>
        <axis xyz="0 0 1"/>
        <limit
        lower="0"
        upper="1.5709"
        effort="1000"
        velocity="2" />
    </joint>

    <joint name="scorbot_pad2_joint" type="revolute">
      <origin xyz="0 0.0545 -0.0905"/>
      <parent link="scorbot_link_5" />
      <child link="scorbot_pad2_Link" />
      <axis xyz="0 0 -1" />
      <limit
        lower="0"
        upper="1.5709"
        effort="1000"
        velocity="2" />
    </joint>

    <!-- Transmissions-->
    <xacro:default_transmission number="1"/>
    <xacro:default_transmission number="2"/>
    <xacro:default_transmission number="3"/>
    <xacro:default_transmission number="4"/>
    <xacro:default_transmission number="5"/>

    <!-- gazebo ros_control plugin -->
    <gazebo>
        <plugin name="gazebo_ros_control" filename="libgazebo_ros_control.so">
            <robotNamespace>/arduinobot</robotNamespace>
            <robotSimType>gazebo_ros_control/DefaultRobotHWSim</robotSimType>
            <legacyModeNS>true</legacyModeNS>
        </plugin>

        <plugin name="joint_5_mimic_joint_4" filename="libroboticsgroup_upatras_gazebo_mimic_joint_plugin.so">
          <joint>joint_4</joint>
          <mimicJoint>joint_5</mimicJoint>
          <multiplier>-1.0</multiplier>
          <offset>0</offset> 
          <maxEffort>${effort}</maxEffort>             
          <robotNamespace>/arduinobot</robotNamespace>
        </plugin>
    </gazebo>




</robot>